<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PETROPLUS</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { background: #fff9db; font-family: 'Segoe UI', sans-serif; }
    .card { border-radius: 20px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    .hidden { display: none; }
    .nav-btn { width: 100%; margin-top: 10px; }
  </style>
</head>
<body>
<div class="container py-5">
  <!-- Login/Registro -->
  <div id="authSection" class="card p-4">
    <h3 class="text-center mb-3">PETROPLUS</h3>
    <div id="toggleAuth" class="text-center mb-3">
      <button class="btn btn-outline-primary btn-sm" onclick="showLogin()">Login</button>
      <button class="btn btn-outline-secondary btn-sm" onclick="showRegister()">Registrar</button>
    </div>
    <div id="loginForm">
      <input id="loginUser" type="text" placeholder="Usuário" class="form-control mb-2" />
      <input id="loginPass" type="password" placeholder="Senha" class="form-control mb-2" />
      <button class="btn btn-primary w-100" onclick="login()">Entrar</button>
    </div>
    <div id="registerForm" class="hidden">
      <input id="regUser" type="text" placeholder="Novo usuário" class="form-control mb-2" />
      <input id="regPass" type="password" placeholder="Senha" class="form-control mb-2" />
      <input id="regPassConfirm" type="password" placeholder="Confirmar Senha" class="form-control mb-2" />
      <button class="btn btn-success w-100" onclick="register()">Registrar</button>
    </div>
  </div>

  <!-- Painel do Usuário -->
  <div id="userPanel" class="card p-4 hidden mt-4">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <div>
        <h5>Olá, <span id="userName"></span></h5>
        <p>Saldo da Conta: <strong>MZN <span id="userBalance">0</span></strong></p>
        <button class="btn btn-outline-primary btn-sm" onclick="showSection('recharge')">Recarregar</button>
      </div>
      <div>
        <p>Ganhos: <strong>MZN <span id="userEarnings">0</span></strong></p>
        <button class="btn btn-outline-success btn-sm" onclick="alert('Solicitação de retirada enviada!')">Retirar</button>
      </div>
    </div>
    <button class="btn btn-secondary nav-btn" onclick="showSection('history')">Ver Histórico</button>
    <button class="btn btn-secondary nav-btn" onclick="showSection('guests')">Meus Convidados</button>
  </div>

  <!-- Página de Recarga -->
  <div id="recharge" class="card p-4 hidden mt-4">
    <h5>Recarregar Conta</h5>
    <input id="rechargeAmount" type="number" placeholder="Valor em MZN" class="form-control mb-2" />
    <button class="btn btn-success w-100" onclick="recharge()">Confirmar Recarga</button>
    <button class="btn btn-link w-100" onclick="backToPanel()">Voltar</button>
  </div>

  <!-- Histórico de Recargas -->
  <div id="history" class="card p-4 hidden mt-4">
    <h5>Histórico de Recargas</h5>
    <ul id="historyList" class="list-group mb-2"></ul>
    <button class="btn btn-link w-100" onclick="backToPanel()">Voltar</button>
  </div>

  <!-- Lista de Convidados -->
  <div id="guests" class="card p-4 hidden mt-4">
    <h5>Meus Convidados</h5>
    <ul id="guestList" class="list-group mb-2"></ul>
    <button class="btn btn-link w-100" onclick="backToPanel()">Voltar</button>
  </div>
</div>

<script>
  const showLogin = () => {
    document.getElementById('loginForm').classList.remove('hidden');
    document.getElementById('registerForm').classList.add('hidden');
  }
  const showRegister = () => {
    document.getElementById('registerForm').classList.remove('hidden');
    document.getElementById('loginForm').classList.add('hidden');
  }
  const register = () => {
    const user = document.getElementById('regUser').value;
    const pass = document.getElementById('regPass').value;
    const pass2 = document.getElementById('regPassConfirm').value;
    if (!user || !pass || !pass2) return alert('Preencha todos os campos.');
    if (pass !== pass2) return alert('As senhas não coincidem.');

    localStorage.setItem('petro_user', user);
    localStorage.setItem('petro_pass', pass);
    localStorage.setItem('petro_balance', '0');
    localStorage.setItem('petro_earnings', '0');
    localStorage.setItem('petro_guests', JSON.stringify([]));
    localStorage.setItem('petro_history', JSON.stringify([]));
    login();
  }
  const login = () => {
    const user = document.getElementById('loginUser').value;
    const pass = document.getElementById('loginPass').value;
    const storedUser = localStorage.getItem('petro_user');
    const storedPass = localStorage.getItem('petro_pass');
    if (user === storedUser && pass === storedPass) {
      document.getElementById('authSection').classList.add('hidden');
      document.getElementById('userPanel').classList.remove('hidden');
      document.getElementById('userName').innerText = user;
      document.getElementById('userBalance').innerText = localStorage.getItem('petro_balance');
      document.getElementById('userEarnings').innerText = localStorage.getItem('petro_earnings');
      updateHistoryList();
      updateGuestList();
    } else {
      alert('Usuário ou senha incorretos.');
    }
  }
  const showSection = (sectionId) => {
    document.getElementById('userPanel').classList.add('hidden');
    document.querySelectorAll('.card').forEach(card => {
      if (card.id === sectionId) card.classList.remove('hidden');
    });
  }
  const backToPanel = () => {
    document.querySelectorAll('.card').forEach(card => card.classList.add('hidden'));
    document.getElementById('userPanel').classList.remove('hidden');
  }
  const recharge = () => {
    const amount = parseInt(document.getElementById('rechargeAmount').value);
    if (amount > 0) {
      const current = parseInt(localStorage.getItem('petro_balance') || '0');
      const history = JSON.parse(localStorage.getItem('petro_history') || '[]');
      history.push({ date: new Date().toLocaleString(), amount });
      localStorage.setItem('petro_balance', current + amount);
      localStorage.setItem('petro_history', JSON.stringify(history));
      document.getElementById('userBalance').innerText = current + amount;
      updateHistoryList();
      alert('Recarga realizada com sucesso!');
      backToPanel();
    }
  }
  const updateHistoryList = () => {
    const list = document.getElementById('historyList');
    const history = JSON.parse(localStorage.getItem('petro_history') || '[]');
    list.innerHTML = '';
    history.forEach(h => {
      const li = document.createElement('li');
      li.className = 'list-group-item';
      li.innerText = `${h.date} - MZN ${h.amount}`;
      list.appendChild(li);
    });
  }
  const updateGuestList = () => {
    const list = document.getElementById('guestList');
    const guests = JSON.parse(localStorage.getItem('petro_guests') || '[]');
    list.innerHTML = '';
    guests.forEach((g, i) => {
      const li = document.createElement('li');
      li.className = 'list-group-item';
      li.innerText = `Convidado ${i + 1}: ${g}`;
      list.appendChild(li);
    });
  }
</script>
</body>
</html>
